{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2 class="text-light">Редактирование задачи</h2>
  <form method="post">
    {% csrf_token %}
    <div class="mb-3">
      <label for="id_name" class="form-label text-light">Название задачи</label>
      <input type="text" class="form-control bg-secondary text-light" id="id_name" name="name" value="{{ form.name.value|default_if_none:'' }}" required>
      {% if form.name.errors %}
        <div class="alert alert-danger text-light bg-secondary mt-2">{{ form.name.errors.0 }}</div>
      {% endif %}
    </div>
    <div class="mb-3">
      <label for="id_description" class="form-label text-light">Описание</label>
      <textarea class="form-control bg-secondary text-light" id="id_description" name="description" rows="3">{{ form.description.value|default_if_none:'' }}</textarea>
      {% if form.description.errors %}
        <div class="alert alert-danger text-light bg-secondary mt-2">{{ form.description.errors.0 }}</div>
      {% endif %}
    </div>
    <div class="mb-3">
      <label for="id_status" class="form-label text-light">Статус</label>
      <select class="form-select bg-secondary text-light" id="id_status" name="status" required>
        <option value="">Выберите статус</option>
        {% for status in statuses %}
          <option value="{{ status.pk }}" {% if form.status.value == status.pk %}selected{% endif %}>{{ status.name }}</option>
        {% endfor %}
      </select>
      {% if form.status.errors %}
        <div class="alert alert-danger text-light bg-secondary mt-2">{{ form.status.errors.0 }}</div>
      {% endif %}
    </div>
    <div class="mb-3">
      <label for="id_assignee" class="form-label text-light">Исполнитель</label>
      <select class="form-select bg-secondary text-light" id="id_assignee" name="assignee">
        <option value="">Не назначен</option>
        {% for user in users %}
          <option value="{{ user.pk }}" {% if form.assignee.value == user.pk %}selected{% endif %}>{{ user.username }}</option>
        {% endfor %}
      </select>
      {% if form.assignee.errors %}
        <div class="alert alert-danger text-light bg-secondary mt-2">{{ form.assignee.errors.0 }}</div>
      {% endif %}
    </div>
    <div class="mb-3">
      <label for="id_labels" class="form-label text-light">Метки</label>
      <select class="form-select bg-secondary text-light" id="id_labels" name="labels" multiple>
        {% for label in labels %}
          <option value="{{ label.pk }}" {% if label in form.instance.labels.all %}selected{% endif %}>{{ label.name }}</option>
        {% endfor %}
      </select>
      {% if form.labels.errors %}
        <div class="alert alert-danger text-light bg-secondary mt-2">{{ form.labels.errors.0 }}</div>
      {% endif %}
    </div>
    <button type="submit" class="btn btn-warning w-100">Обновить</button>
  </form>
</div>
{% endblock %}